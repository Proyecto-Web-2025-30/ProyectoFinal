{"ast":null,"code":"import { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { NavbarComponent } from '../navbar/navbar.component';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"../../services/process.service\";\nimport * as i3 from \"../../services/activity.service\";\nimport * as i4 from \"../../services/gateway.service\";\nimport * as i5 from \"../../services/arc.service\";\nimport * as i6 from \"../../services/role.service\";\nimport * as i7 from \"../../services/auth.service\";\nimport * as i8 from \"@angular/common\";\nimport * as i9 from \"@angular/forms\";\nfunction ProcessDetailsComponent__svg_line_31_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵnamespaceSVG();\n    i0.ɵɵelement(0, \"line\", 18);\n  }\n  if (rf & 2) {\n    const arc_r2 = ctx.$implicit;\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵattribute(\"x1\", ctx_r2.getNodeCenterX(arc_r2.sourceType, arc_r2.sourceId))(\"y1\", ctx_r2.getNodeCenterY(arc_r2.sourceType, arc_r2.sourceId))(\"x2\", ctx_r2.getNodeCenterX(arc_r2.targetType, arc_r2.targetId))(\"y2\", ctx_r2.getNodeCenterY(arc_r2.targetType, arc_r2.targetId));\n  }\n}\nfunction ProcessDetailsComponent_div_35_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 19);\n    i0.ɵɵlistener(\"click\", function ProcessDetailsComponent_div_35_Template_div_click_0_listener($event) {\n      const a_r5 = i0.ɵɵrestoreView(_r4).$implicit;\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.onNodeClick($event, \"ACTIVITY\", a_r5));\n    })(\"mousedown\", function ProcessDetailsComponent_div_35_Template_div_mousedown_0_listener($event) {\n      const a_r5 = i0.ɵɵrestoreView(_r4).$implicit;\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.onNodeMouseDown($event, \"ACTIVITY\", a_r5));\n    });\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const a_r5 = ctx.$implicit;\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵstyleProp(\"left\", a_r5.x || 40, \"px\")(\"top\", a_r5.y || 40, \"px\");\n    i0.ɵɵclassProp(\"selected\", ctx_r2.isSelected(\"ACTIVITY\", a_r5.id));\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", a_r5.name || \"Activity\", \" \");\n  }\n}\nfunction ProcessDetailsComponent_div_36_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r6 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 20);\n    i0.ɵɵlistener(\"click\", function ProcessDetailsComponent_div_36_Template_div_click_0_listener($event) {\n      const g_r7 = i0.ɵɵrestoreView(_r6).$implicit;\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.onNodeClick($event, \"GATEWAY\", g_r7));\n    })(\"mousedown\", function ProcessDetailsComponent_div_36_Template_div_mousedown_0_listener($event) {\n      const g_r7 = i0.ɵɵrestoreView(_r6).$implicit;\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.onNodeMouseDown($event, \"GATEWAY\", g_r7));\n    });\n    i0.ɵɵelementStart(1, \"span\", 6);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const g_r7 = ctx.$implicit;\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵstyleProp(\"left\", g_r7.x || 40, \"px\")(\"top\", g_r7.y || 40, \"px\");\n    i0.ɵɵclassProp(\"selected\", ctx_r2.isSelected(\"GATEWAY\", g_r7.id));\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", g_r7.gatewayType === \"EXCLUSIVE\" ? \"\\u00D7\" : g_r7.gatewayType === \"PARALLEL\" ? \"\\uFF0B\" : \"\\u25EF\", \" \");\n  }\n}\nfunction ProcessDetailsComponent_div_37_div_3_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r8 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\")(1, \"label\");\n    i0.ɵɵtext(2, \"Name\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"input\", 23);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function ProcessDetailsComponent_div_37_div_3_Template_input_ngModelChange_3_listener($event) {\n      i0.ɵɵrestoreView(_r8);\n      const ctx_r2 = i0.ɵɵnextContext(2);\n      i0.ɵɵtwoWayBindingSet(ctx_r2.activityForm.name, $event) || (ctx_r2.activityForm.name = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"label\");\n    i0.ɵɵtext(5, \"Type\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"input\", 23);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function ProcessDetailsComponent_div_37_div_3_Template_input_ngModelChange_6_listener($event) {\n      i0.ɵɵrestoreView(_r8);\n      const ctx_r2 = i0.ɵɵnextContext(2);\n      i0.ɵɵtwoWayBindingSet(ctx_r2.activityForm.activityType, $event) || (ctx_r2.activityForm.activityType = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"label\");\n    i0.ɵɵtext(8, \"Description\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"textarea\", 23);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function ProcessDetailsComponent_div_37_div_3_Template_textarea_ngModelChange_9_listener($event) {\n      i0.ɵɵrestoreView(_r8);\n      const ctx_r2 = i0.ɵɵnextContext(2);\n      i0.ɵɵtwoWayBindingSet(ctx_r2.activityForm.description, $event) || (ctx_r2.activityForm.description = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"button\", 24);\n    i0.ɵɵlistener(\"click\", function ProcessDetailsComponent_div_37_div_3_Template_button_click_10_listener() {\n      i0.ɵɵrestoreView(_r8);\n      const ctx_r2 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r2.saveSelected());\n    });\n    i0.ɵɵtext(11, \"Save\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"button\", 24);\n    i0.ɵɵlistener(\"click\", function ProcessDetailsComponent_div_37_div_3_Template_button_click_12_listener() {\n      i0.ɵɵrestoreView(_r8);\n      const ctx_r2 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r2.deleteSelected());\n    });\n    i0.ɵɵtext(13, \"Delete\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r2.activityForm.name);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r2.activityForm.activityType);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r2.activityForm.description);\n  }\n}\nfunction ProcessDetailsComponent_div_37_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r9 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\")(1, \"label\");\n    i0.ɵɵtext(2, \"Name\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"input\", 23);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function ProcessDetailsComponent_div_37_div_4_Template_input_ngModelChange_3_listener($event) {\n      i0.ɵɵrestoreView(_r9);\n      const ctx_r2 = i0.ɵɵnextContext(2);\n      i0.ɵɵtwoWayBindingSet(ctx_r2.gatewayForm.name, $event) || (ctx_r2.gatewayForm.name = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"label\");\n    i0.ɵɵtext(5, \"Type\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"select\", 23);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function ProcessDetailsComponent_div_37_div_4_Template_select_ngModelChange_6_listener($event) {\n      i0.ɵɵrestoreView(_r9);\n      const ctx_r2 = i0.ɵɵnextContext(2);\n      i0.ɵɵtwoWayBindingSet(ctx_r2.gatewayForm.gatewayType, $event) || (ctx_r2.gatewayForm.gatewayType = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementStart(7, \"option\", 25);\n    i0.ɵɵtext(8, \"Exclusive\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"option\", 26);\n    i0.ɵɵtext(10, \"Parallel\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"option\", 27);\n    i0.ɵɵtext(12, \"Inclusive\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(13, \"label\");\n    i0.ɵɵtext(14, \"Conditions\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(15, \"textarea\", 23);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function ProcessDetailsComponent_div_37_div_4_Template_textarea_ngModelChange_15_listener($event) {\n      i0.ɵɵrestoreView(_r9);\n      const ctx_r2 = i0.ɵɵnextContext(2);\n      i0.ɵɵtwoWayBindingSet(ctx_r2.gatewayForm.conditions, $event) || (ctx_r2.gatewayForm.conditions = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(16, \"button\", 24);\n    i0.ɵɵlistener(\"click\", function ProcessDetailsComponent_div_37_div_4_Template_button_click_16_listener() {\n      i0.ɵɵrestoreView(_r9);\n      const ctx_r2 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r2.saveSelected());\n    });\n    i0.ɵɵtext(17, \"Save\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(18, \"button\", 24);\n    i0.ɵɵlistener(\"click\", function ProcessDetailsComponent_div_37_div_4_Template_button_click_18_listener() {\n      i0.ɵɵrestoreView(_r9);\n      const ctx_r2 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r2.deleteSelected());\n    });\n    i0.ɵɵtext(19, \"Delete\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r2.gatewayForm.name);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r2.gatewayForm.gatewayType);\n    i0.ɵɵadvance(9);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r2.gatewayForm.conditions);\n  }\n}\nfunction ProcessDetailsComponent_div_37_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 21)(1, \"h3\");\n    i0.ɵɵtext(2, \"Properties\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(3, ProcessDetailsComponent_div_37_div_3_Template, 14, 3, \"div\", 22)(4, ProcessDetailsComponent_div_37_div_4_Template, 20, 3, \"div\", 22);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.selected.type === \"ACTIVITY\");\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.selected.type === \"GATEWAY\");\n  }\n}\nexport class ProcessDetailsComponent {\n  constructor(route, router, processService, activityService, gatewayService, arcService, roleService, authService) {\n    this.route = route;\n    this.router = router;\n    this.processService = processService;\n    this.activityService = activityService;\n    this.gatewayService = gatewayService;\n    this.arcService = arcService;\n    this.roleService = roleService;\n    this.authService = authService;\n    this.process = null;\n    this.activities = [];\n    this.gateways = [];\n    this.arcs = [];\n    this.roles = [];\n    // Selection & forms\n    this.selected = null;\n    this.activityForm = {};\n    this.gatewayForm = {};\n    this.pendingArcSource = null;\n    this.dragging = null;\n    this.onWindowMouseMove = event => {\n      if (!this.dragging) return;\n      const canvas = document.querySelector('.canvas');\n      const rect = canvas.getBoundingClientRect();\n      const mouseX = event.clientX - rect.left;\n      const mouseY = event.clientY - rect.top;\n      const newX = Math.max(0, mouseX - this.dragging.offsetX);\n      const newY = Math.max(0, mouseY - this.dragging.offsetY);\n      if (this.dragging.type === 'ACTIVITY') {\n        const idx = this.activities.findIndex(a => a.id === this.dragging.id);\n        if (idx >= 0) {\n          this.activities[idx] = {\n            ...this.activities[idx],\n            x: newX,\n            y: newY\n          };\n        }\n      } else {\n        const idx = this.gateways.findIndex(g => g.id === this.dragging.id);\n        if (idx >= 0) {\n          this.gateways[idx] = {\n            ...this.gateways[idx],\n            x: newX,\n            y: newY\n          };\n        }\n      }\n    };\n    this.onWindowMouseUp = () => {\n      if (!this.dragging) return;\n      const {\n        type,\n        id\n      } = this.dragging;\n      this.dragging = null;\n      window.removeEventListener('mousemove', this.onWindowMouseMove);\n      window.removeEventListener('mouseup', this.onWindowMouseUp);\n      if (type === 'ACTIVITY') {\n        const a = this.activities.find(x => x.id === id);\n        if (a) {\n          const payload = {\n            name: a.name,\n            activityType: a.activityType,\n            description: a.description,\n            x: a.x,\n            y: a.y\n          };\n          this.activityService.updateActivity(a.id, payload).subscribe();\n        }\n      } else {\n        const g = this.gateways.find(x => x.id === id);\n        if (g) {\n          const payload = {\n            name: g.name,\n            gatewayType: g.gatewayType,\n            conditions: g.conditions,\n            x: g.x,\n            y: g.y\n          };\n          this.gatewayService.updateGateway(g.id, payload).subscribe();\n        }\n      }\n    };\n  }\n  ngOnInit() {\n    this.processId = Number(this.route.snapshot.paramMap.get('id'));\n    this.loadProcessDetails();\n    this.loadRoles();\n  }\n  loadProcessDetails() {\n    this.processService.getProcess(this.processId).subscribe({\n      next: data => this.process = data\n    });\n    console.log(this.process);\n    this.loadActivities();\n    this.loadGateways();\n    this.loadArcs();\n  }\n  loadActivities() {\n    this.activityService.getActivitiesByProcess(this.processId).subscribe({\n      next: data => this.activities = data\n    });\n  }\n  loadGateways() {\n    this.gatewayService.getGatewaysByProcess(this.processId).subscribe({\n      next: data => this.gateways = data\n    });\n  }\n  loadArcs() {\n    this.arcService.getArcsByProcess(this.processId).subscribe({\n      next: data => this.arcs = data\n    });\n  }\n  loadRoles() {\n    const user = this.authService.getCurrentUser();\n    if (user) {\n      this.roleService.getRolesByCompany(user.companyId).subscribe({\n        next: data => this.roles = data\n      });\n    }\n  }\n  // Palette drag start\n  onPaletteDragStart(event, payload) {\n    event.dataTransfer?.setData('text/plain', payload);\n  }\n  onCanvasDragOver(event) {\n    event.preventDefault();\n  }\n  onCanvasDrop(event) {\n    event.preventDefault();\n    const payload = event.dataTransfer?.getData('text/plain');\n    if (!payload) return;\n    const canvasRect = event.currentTarget.getBoundingClientRect();\n    const x = event.clientX - canvasRect.left;\n    const y = event.clientY - canvasRect.top;\n    if (payload === 'ACTIVITY') {\n      const activity = {\n        name: 'Activity',\n        activityType: '',\n        description: '',\n        x,\n        y\n      };\n      this.activityService.createActivity(this.processId, activity).subscribe({\n        next: created => {\n          this.activities = [...this.activities, created];\n          this.selectNode('ACTIVITY', created.id);\n        }\n      });\n    } else if (payload.startsWith('GATEWAY:')) {\n      const type = payload.split(':')[1];\n      const gateway = {\n        name: type + ' Gateway',\n        gatewayType: type,\n        conditions: '',\n        x,\n        y\n      };\n      this.gatewayService.createGateway(this.processId, gateway).subscribe({\n        next: created => {\n          this.gateways = [...this.gateways, created];\n          this.selectNode('GATEWAY', created.id);\n        }\n      });\n    }\n  }\n  onCanvasClick(event) {\n    if (event.target.classList.contains('canvas')) {\n      this.selected = null;\n      this.pendingArcSource = null;\n    }\n  }\n  onNodeMouseDown(event, type, node) {\n    event.preventDefault();\n    const canvas = event.currentTarget.closest('.canvas');\n    const canvasRect = canvas ? canvas.getBoundingClientRect() : document.querySelector('.canvas').getBoundingClientRect();\n    const nodeX = node.x || 40;\n    const nodeY = node.y || 40;\n    const mouseX = event.clientX - canvasRect.left;\n    const mouseY = event.clientY - canvasRect.top;\n    this.dragging = {\n      type,\n      id: node.id,\n      offsetX: mouseX - nodeX,\n      offsetY: mouseY - nodeY\n    };\n    // Bind listeners on window to allow smooth dragging outside node element\n    window.addEventListener('mousemove', this.onWindowMouseMove);\n    window.addEventListener('mouseup', this.onWindowMouseUp);\n  }\n  onNodeClick(event, type, node) {\n    event.stopPropagation();\n    if (event.shiftKey) {\n      if (!this.pendingArcSource) {\n        this.pendingArcSource = {\n          type,\n          id: node.id\n        };\n      } else {\n        const source = this.pendingArcSource;\n        const target = {\n          type,\n          id: node.id\n        };\n        if (!(source.type === target.type && source.id === target.id)) {\n          this.arcService.createArc(this.processId, {\n            sourceType: source.type,\n            sourceId: source.id,\n            targetType: target.type,\n            targetId: target.id\n          }).subscribe({\n            next: created => {\n              this.arcs = [...this.arcs, created];\n              this.pendingArcSource = null;\n            }\n          });\n        }\n      }\n      return;\n    }\n    this.selectNode(type, node.id);\n  }\n  selectNode(type, id) {\n    this.selected = {\n      type,\n      id\n    };\n    if (type === 'ACTIVITY') {\n      const a = this.activities.find(x => x.id === id);\n      this.activityForm = {\n        name: a.name,\n        activityType: a.activityType,\n        description: a.description\n      };\n      this.gatewayForm = {};\n    } else {\n      const g = this.gateways.find(x => x.id === id);\n      this.gatewayForm = {\n        name: g.name,\n        gatewayType: g.gatewayType,\n        conditions: g.conditions\n      };\n      this.activityForm = {};\n    }\n  }\n  isSelected(type, id) {\n    return !!this.selected && this.selected.type === type && this.selected.id === id;\n  }\n  saveSelected() {\n    if (!this.selected) return;\n    if (this.selected.type === 'ACTIVITY') {\n      const a = this.activities.find(x => x.id === this.selected.id);\n      const payload = {\n        name: this.activityForm.name || a.name,\n        activityType: this.activityForm.activityType || a.activityType,\n        description: this.activityForm.description || a.description,\n        x: a.x,\n        y: a.y\n      };\n      this.activityService.updateActivity(a.id, payload).subscribe({\n        next: updated => {\n          this.loadActivities();\n        }\n      });\n    } else {\n      const g = this.gateways.find(x => x.id === this.selected.id);\n      const payload = {\n        name: this.gatewayForm.name || g.name,\n        gatewayType: this.gatewayForm.gatewayType || g.gatewayType,\n        conditions: this.gatewayForm.conditions || g.conditions,\n        x: g.x,\n        y: g.y\n      };\n      this.gatewayService.updateGateway(g.id, payload).subscribe({\n        next: () => {\n          this.loadGateways();\n        }\n      });\n    }\n  }\n  deleteSelected() {\n    if (!this.selected) return;\n    if (this.selected.type === 'ACTIVITY') {\n      this.activityService.deleteActivity(this.selected.id).subscribe({\n        next: () => {\n          this.activities = this.activities.filter(a => a.id !== this.selected.id);\n          this.arcs = this.arcs.filter(e => !(e.sourceType === 'ACTIVITY' && e.sourceId === this.selected.id) && !(e.targetType === 'ACTIVITY' && e.targetId === this.selected.id));\n          this.selected = null;\n        }\n      });\n    } else {\n      this.gatewayService.deleteGateway(this.selected.id).subscribe({\n        next: () => {\n          this.gateways = this.gateways.filter(g => g.id !== this.selected.id);\n          this.arcs = this.arcs.filter(e => !(e.sourceType === 'GATEWAY' && e.sourceId === this.selected.id) && !(e.targetType === 'GATEWAY' && e.targetId === this.selected.id));\n          this.selected = null;\n        }\n      });\n    }\n  }\n  getNodeCenterX(type, id) {\n    if (!id) return 0;\n    const node = type === 'ACTIVITY' ? this.activities.find(a => a.id === id) : this.gateways.find(g => g.id === id);\n    const halfWidth = type === 'GATEWAY' ? 18 : 50;\n    const x = (node?.x || 40) + halfWidth;\n    return x;\n  }\n  getNodeCenterY(type, id) {\n    if (!id) return 0;\n    const node = type === 'ACTIVITY' ? this.activities.find(a => a.id === id) : this.gateways.find(g => g.id === id);\n    const halfHeight = type === 'GATEWAY' ? 18 : 20;\n    const y = (node?.y || 40) + halfHeight;\n    return y;\n  }\n  static {\n    this.ɵfac = function ProcessDetailsComponent_Factory(t) {\n      return new (t || ProcessDetailsComponent)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.ProcessService), i0.ɵɵdirectiveInject(i3.ActivityService), i0.ɵɵdirectiveInject(i4.GatewayService), i0.ɵɵdirectiveInject(i5.ArcService), i0.ɵɵdirectiveInject(i6.RoleService), i0.ɵɵdirectiveInject(i7.AuthService));\n    };\n  }\n  static {\n    this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: ProcessDetailsComponent,\n      selectors: [[\"app-process-details\"]],\n      standalone: true,\n      features: [i0.ɵɵStandaloneFeature],\n      decls: 38,\n      vars: 4,\n      consts: [[\"canvas\", \"\"], [1, \"designer\"], [\"draggable\", \"false\", 1, \"sidebar\"], [\"draggable\", \"true\", 1, \"palette-item\", \"activity\", 3, \"dragstart\"], [\"draggable\", \"true\", 1, \"palette-gateway\", 3, \"dragstart\"], [1, \"diamond\"], [1, \"marker\"], [1, \"label\"], [1, \"hint\"], [1, \"canvas-wrapper\"], [1, \"canvas\", 3, \"dragover\", \"drop\", \"click\"], [\"xmlns\", \"http://www.w3.org/2000/svg\", 1, \"edges\"], [\"stroke\", \"#999\", \"stroke-width\", \"2\", \"marker-end\", \"url(#arrow)\", 4, \"ngFor\", \"ngForOf\"], [\"id\", \"arrow\", \"markerWidth\", \"10\", \"markerHeight\", \"10\", \"refX\", \"10\", \"refY\", \"3\", \"orient\", \"auto\", \"markerUnits\", \"strokeWidth\"], [\"d\", \"M0,0 L0,6 L9,3 z\", \"fill\", \"#999\"], [\"class\", \"node activity-node\", 3, \"selected\", \"left\", \"top\", \"click\", \"mousedown\", 4, \"ngFor\", \"ngForOf\"], [\"class\", \"node gateway-node\", 3, \"selected\", \"left\", \"top\", \"click\", \"mousedown\", 4, \"ngFor\", \"ngForOf\"], [\"class\", \"inspector\", 4, \"ngIf\"], [\"stroke\", \"#999\", \"stroke-width\", \"2\", \"marker-end\", \"url(#arrow)\"], [1, \"node\", \"activity-node\", 3, \"click\", \"mousedown\"], [1, \"node\", \"gateway-node\", 3, \"click\", \"mousedown\"], [1, \"inspector\"], [4, \"ngIf\"], [3, \"ngModelChange\", \"ngModel\"], [3, \"click\"], [\"value\", \"EXCLUSIVE\"], [\"value\", \"PARALLEL\"], [\"value\", \"INCLUSIVE\"]],\n      template: function ProcessDetailsComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          const _r1 = i0.ɵɵgetCurrentView();\n          i0.ɵɵelement(0, \"app-navbar\");\n          i0.ɵɵelementStart(1, \"div\", 1)(2, \"div\", 2)(3, \"h3\");\n          i0.ɵɵtext(4, \"Palette\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(5, \"div\", 3);\n          i0.ɵɵlistener(\"dragstart\", function ProcessDetailsComponent_Template_div_dragstart_5_listener($event) {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.onPaletteDragStart($event, \"ACTIVITY\"));\n          });\n          i0.ɵɵtext(6, \"Activity\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(7, \"div\", 4);\n          i0.ɵɵlistener(\"dragstart\", function ProcessDetailsComponent_Template_div_dragstart_7_listener($event) {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.onPaletteDragStart($event, \"GATEWAY:EXCLUSIVE\"));\n          });\n          i0.ɵɵelementStart(8, \"div\", 5)(9, \"span\", 6);\n          i0.ɵɵtext(10, \"\\u00D7\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(11, \"span\", 7);\n          i0.ɵɵtext(12, \"Exclusive Gateway\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(13, \"div\", 4);\n          i0.ɵɵlistener(\"dragstart\", function ProcessDetailsComponent_Template_div_dragstart_13_listener($event) {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.onPaletteDragStart($event, \"GATEWAY:PARALLEL\"));\n          });\n          i0.ɵɵelementStart(14, \"div\", 5)(15, \"span\", 6);\n          i0.ɵɵtext(16, \"\\uFF0B\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(17, \"span\", 7);\n          i0.ɵɵtext(18, \"Parallel Gateway\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(19, \"div\", 4);\n          i0.ɵɵlistener(\"dragstart\", function ProcessDetailsComponent_Template_div_dragstart_19_listener($event) {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.onPaletteDragStart($event, \"GATEWAY:INCLUSIVE\"));\n          });\n          i0.ɵɵelementStart(20, \"div\", 5)(21, \"span\", 6);\n          i0.ɵɵtext(22, \"\\u25EF\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(23, \"span\", 7);\n          i0.ɵɵtext(24, \"Inclusive Gateway\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(25, \"div\", 8);\n          i0.ɵɵtext(26, \"Tip: Hold Shift and click source, then click target to create an arc.\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(27, \"div\", 9)(28, \"div\", 10, 0);\n          i0.ɵɵlistener(\"dragover\", function ProcessDetailsComponent_Template_div_dragover_28_listener($event) {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.onCanvasDragOver($event));\n          })(\"drop\", function ProcessDetailsComponent_Template_div_drop_28_listener($event) {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.onCanvasDrop($event));\n          })(\"click\", function ProcessDetailsComponent_Template_div_click_28_listener($event) {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.onCanvasClick($event));\n          });\n          i0.ɵɵnamespaceSVG();\n          i0.ɵɵelementStart(30, \"svg\", 11);\n          i0.ɵɵtemplate(31, ProcessDetailsComponent__svg_line_31_Template, 1, 4, \"line\", 12);\n          i0.ɵɵelementStart(32, \"defs\")(33, \"marker\", 13);\n          i0.ɵɵelement(34, \"path\", 14);\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵtemplate(35, ProcessDetailsComponent_div_35_Template, 2, 7, \"div\", 15)(36, ProcessDetailsComponent_div_36_Template, 3, 7, \"div\", 16);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵtemplate(37, ProcessDetailsComponent_div_37_Template, 5, 2, \"div\", 17);\n          i0.ɵɵelementEnd();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(31);\n          i0.ɵɵproperty(\"ngForOf\", ctx.arcs);\n          i0.ɵɵadvance(4);\n          i0.ɵɵproperty(\"ngForOf\", ctx.activities);\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngForOf\", ctx.gateways);\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngIf\", ctx.selected);\n        }\n      },\n      dependencies: [CommonModule, i8.NgForOf, i8.NgIf, FormsModule, i9.NgSelectOption, i9.ɵNgSelectMultipleOption, i9.DefaultValueAccessor, i9.SelectControlValueAccessor, i9.NgControlStatus, i9.NgModel, NavbarComponent],\n      styles: [\".designer[_ngcontent-%COMP%] { display: grid; grid-template-columns: 220px 1fr 300px; height: calc(100vh - 60px); }\\n.sidebar[_ngcontent-%COMP%] { padding: 12px; border-right: 1px solid #ddd; overflow: auto; }\\n.palette-item[_ngcontent-%COMP%] { padding: 8px; margin-bottom: 8px; background: #f5f5f5; border: 1px solid #ddd; cursor: grab; }\\n.palette-gateway[_ngcontent-%COMP%] { display: flex; align-items: center; gap: 10px; padding: 6px 4px; margin-bottom: 10px; cursor: grab; }\\n.palette-gateway[_ngcontent-%COMP%]   .diamond[_ngcontent-%COMP%] { width: 36px; height: 36px; background: #fff3e0; border: 2px solid #f57c00; transform: rotate(45deg); position: relative; display: flex; align-items: center; justify-content: center; }\\n.palette-gateway[_ngcontent-%COMP%]   .marker[_ngcontent-%COMP%] { transform: rotate(-45deg); color: #f57c00; font-weight: 700; font-size: 18px; line-height: 1; }\\n.palette-gateway[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%] { -webkit-user-select: none; user-select: none; }\\n.hint[_ngcontent-%COMP%] { font-size: 12px; color: #666; margin-top: 12px; }\\n.canvas-wrapper[_ngcontent-%COMP%] { position: relative; }\\n.canvas[_ngcontent-%COMP%] { position: relative; width: 100%; height: 100%; background: #fff; overflow: hidden; }\\n.edges[_ngcontent-%COMP%] { position: absolute; width: 100%; height: 100%; pointer-events: none; }\\n.node[_ngcontent-%COMP%] { position: absolute; min-width: 100px; min-height: 40px; padding: 8px; background: #e9f2ff; border: 2px solid #1976d2; border-radius: 6px; -webkit-user-select: none; user-select: none; }\\n.activity-node[_ngcontent-%COMP%] { background: #e9f2ff; }\\n.gateway-node[_ngcontent-%COMP%] { background: #fff3e0; border-color: #f57c00; min-width: 0; min-height: 0; width: 36px; height: 36px; padding: 0; border-radius: 0; display: flex; align-items: center; justify-content: center; transform: rotate(45deg); }\\n.gateway-node[_ngcontent-%COMP%]   .marker[_ngcontent-%COMP%] { transform: rotate(-45deg); color: #f57c00; font-weight: 700; font-size: 18px; line-height: 1; pointer-events: none; }\\n.node.selected[_ngcontent-%COMP%] { outline: 2px dashed #673ab7; }\\n.inspector[_ngcontent-%COMP%] { padding: 12px; border-left: 1px solid #ddd; overflow: auto; }\\n.inspector[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .inspector[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%], .inspector[_ngcontent-%COMP%]   select[_ngcontent-%COMP%] { width: 100%; margin-bottom: 8px; }\\n\\n\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvY29tcG9uZW50cy9wcm9jZXNzLWRldGFpbHMvcHJvY2Vzcy1kZXRhaWxzLmNvbXBvbmVudC5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsWUFBWSxhQUFhLEVBQUUsc0NBQXNDLEVBQUUsMEJBQTBCLEVBQUU7QUFDL0YsV0FBVyxhQUFhLEVBQUUsNEJBQTRCLEVBQUUsY0FBYyxFQUFFO0FBQ3hFLGdCQUFnQixZQUFZLEVBQUUsa0JBQWtCLEVBQUUsbUJBQW1CLEVBQUUsc0JBQXNCLEVBQUUsWUFBWSxFQUFFO0FBQzdHLG1CQUFtQixhQUFhLEVBQUUsbUJBQW1CLEVBQUUsU0FBUyxFQUFFLGdCQUFnQixFQUFFLG1CQUFtQixFQUFFLFlBQVksRUFBRTtBQUN2SCw0QkFBNEIsV0FBVyxFQUFFLFlBQVksRUFBRSxtQkFBbUIsRUFBRSx5QkFBeUIsRUFBRSx3QkFBd0IsRUFBRSxrQkFBa0IsRUFBRSxhQUFhLEVBQUUsbUJBQW1CLEVBQUUsdUJBQXVCLEVBQUU7QUFDbE4sMkJBQTJCLHlCQUF5QixFQUFFLGNBQWMsRUFBRSxnQkFBZ0IsRUFBRSxlQUFlLEVBQUUsY0FBYyxFQUFFO0FBQ3pILDBCQUEwQix5QkFBaUIsRUFBakIsaUJBQWlCLEVBQUU7QUFDN0MsUUFBUSxlQUFlLEVBQUUsV0FBVyxFQUFFLGdCQUFnQixFQUFFO0FBQ3hELGtCQUFrQixrQkFBa0IsRUFBRTtBQUN0QyxVQUFVLGtCQUFrQixFQUFFLFdBQVcsRUFBRSxZQUFZLEVBQUUsZ0JBQWdCLEVBQUUsZ0JBQWdCLEVBQUU7QUFDN0YsU0FBUyxrQkFBa0IsRUFBRSxXQUFXLEVBQUUsWUFBWSxFQUFFLG9CQUFvQixFQUFFO0FBQzlFLFFBQVEsa0JBQWtCLEVBQUUsZ0JBQWdCLEVBQUUsZ0JBQWdCLEVBQUUsWUFBWSxFQUFFLG1CQUFtQixFQUFFLHlCQUF5QixFQUFFLGtCQUFrQixFQUFFLHlCQUFpQixFQUFqQixpQkFBaUIsRUFBRTtBQUNySyxpQkFBaUIsbUJBQW1CLEVBQUU7QUFDdEMsZ0JBQWdCLG1CQUFtQixFQUFFLHFCQUFxQixFQUFFLFlBQVksRUFBRSxhQUFhLEVBQUUsV0FBVyxFQUFFLFlBQVksRUFBRSxVQUFVLEVBQUUsZ0JBQWdCLEVBQUUsYUFBYSxFQUFFLG1CQUFtQixFQUFFLHVCQUF1QixFQUFFLHdCQUF3QixFQUFFO0FBQ3pPLHdCQUF3Qix5QkFBeUIsRUFBRSxjQUFjLEVBQUUsZ0JBQWdCLEVBQUUsZUFBZSxFQUFFLGNBQWMsRUFBRSxvQkFBb0IsRUFBRTtBQUM1SSxpQkFBaUIsMkJBQTJCLEVBQUU7QUFDOUMsYUFBYSxhQUFhLEVBQUUsMkJBQTJCLEVBQUUsY0FBYyxFQUFFO0FBQ3pFLDJEQUEyRCxXQUFXLEVBQUUsa0JBQWtCLEVBQUUiLCJzb3VyY2VzQ29udGVudCI6WyIuZGVzaWduZXIgeyBkaXNwbGF5OiBncmlkOyBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDIyMHB4IDFmciAzMDBweDsgaGVpZ2h0OiBjYWxjKDEwMHZoIC0gNjBweCk7IH1cclxuLnNpZGViYXIgeyBwYWRkaW5nOiAxMnB4OyBib3JkZXItcmlnaHQ6IDFweCBzb2xpZCAjZGRkOyBvdmVyZmxvdzogYXV0bzsgfVxyXG4ucGFsZXR0ZS1pdGVtIHsgcGFkZGluZzogOHB4OyBtYXJnaW4tYm90dG9tOiA4cHg7IGJhY2tncm91bmQ6ICNmNWY1ZjU7IGJvcmRlcjogMXB4IHNvbGlkICNkZGQ7IGN1cnNvcjogZ3JhYjsgfVxyXG4ucGFsZXR0ZS1nYXRld2F5IHsgZGlzcGxheTogZmxleDsgYWxpZ24taXRlbXM6IGNlbnRlcjsgZ2FwOiAxMHB4OyBwYWRkaW5nOiA2cHggNHB4OyBtYXJnaW4tYm90dG9tOiAxMHB4OyBjdXJzb3I6IGdyYWI7IH1cclxuLnBhbGV0dGUtZ2F0ZXdheSAuZGlhbW9uZCB7IHdpZHRoOiAzNnB4OyBoZWlnaHQ6IDM2cHg7IGJhY2tncm91bmQ6ICNmZmYzZTA7IGJvcmRlcjogMnB4IHNvbGlkICNmNTdjMDA7IHRyYW5zZm9ybTogcm90YXRlKDQ1ZGVnKTsgcG9zaXRpb246IHJlbGF0aXZlOyBkaXNwbGF5OiBmbGV4OyBhbGlnbi1pdGVtczogY2VudGVyOyBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsgfVxyXG4ucGFsZXR0ZS1nYXRld2F5IC5tYXJrZXIgeyB0cmFuc2Zvcm06IHJvdGF0ZSgtNDVkZWcpOyBjb2xvcjogI2Y1N2MwMDsgZm9udC13ZWlnaHQ6IDcwMDsgZm9udC1zaXplOiAxOHB4OyBsaW5lLWhlaWdodDogMTsgfVxyXG4ucGFsZXR0ZS1nYXRld2F5IC5sYWJlbCB7IHVzZXItc2VsZWN0OiBub25lOyB9XHJcbi5oaW50IHsgZm9udC1zaXplOiAxMnB4OyBjb2xvcjogIzY2NjsgbWFyZ2luLXRvcDogMTJweDsgfVxyXG4uY2FudmFzLXdyYXBwZXIgeyBwb3NpdGlvbjogcmVsYXRpdmU7IH1cclxuLmNhbnZhcyB7IHBvc2l0aW9uOiByZWxhdGl2ZTsgd2lkdGg6IDEwMCU7IGhlaWdodDogMTAwJTsgYmFja2dyb3VuZDogI2ZmZjsgb3ZlcmZsb3c6IGhpZGRlbjsgfVxyXG4uZWRnZXMgeyBwb3NpdGlvbjogYWJzb2x1dGU7IHdpZHRoOiAxMDAlOyBoZWlnaHQ6IDEwMCU7IHBvaW50ZXItZXZlbnRzOiBub25lOyB9XHJcbi5ub2RlIHsgcG9zaXRpb246IGFic29sdXRlOyBtaW4td2lkdGg6IDEwMHB4OyBtaW4taGVpZ2h0OiA0MHB4OyBwYWRkaW5nOiA4cHg7IGJhY2tncm91bmQ6ICNlOWYyZmY7IGJvcmRlcjogMnB4IHNvbGlkICMxOTc2ZDI7IGJvcmRlci1yYWRpdXM6IDZweDsgdXNlci1zZWxlY3Q6IG5vbmU7IH1cclxuLmFjdGl2aXR5LW5vZGUgeyBiYWNrZ3JvdW5kOiAjZTlmMmZmOyB9XHJcbi5nYXRld2F5LW5vZGUgeyBiYWNrZ3JvdW5kOiAjZmZmM2UwOyBib3JkZXItY29sb3I6ICNmNTdjMDA7IG1pbi13aWR0aDogMDsgbWluLWhlaWdodDogMDsgd2lkdGg6IDM2cHg7IGhlaWdodDogMzZweDsgcGFkZGluZzogMDsgYm9yZGVyLXJhZGl1czogMDsgZGlzcGxheTogZmxleDsgYWxpZ24taXRlbXM6IGNlbnRlcjsganVzdGlmeS1jb250ZW50OiBjZW50ZXI7IHRyYW5zZm9ybTogcm90YXRlKDQ1ZGVnKTsgfVxyXG4uZ2F0ZXdheS1ub2RlIC5tYXJrZXIgeyB0cmFuc2Zvcm06IHJvdGF0ZSgtNDVkZWcpOyBjb2xvcjogI2Y1N2MwMDsgZm9udC13ZWlnaHQ6IDcwMDsgZm9udC1zaXplOiAxOHB4OyBsaW5lLWhlaWdodDogMTsgcG9pbnRlci1ldmVudHM6IG5vbmU7IH1cclxuLm5vZGUuc2VsZWN0ZWQgeyBvdXRsaW5lOiAycHggZGFzaGVkICM2NzNhYjc7IH1cclxuLmluc3BlY3RvciB7IHBhZGRpbmc6IDEycHg7IGJvcmRlci1sZWZ0OiAxcHggc29saWQgI2RkZDsgb3ZlcmZsb3c6IGF1dG87IH1cclxuLmluc3BlY3RvciBpbnB1dCwgLmluc3BlY3RvciB0ZXh0YXJlYSwgLmluc3BlY3RvciBzZWxlY3QgeyB3aWR0aDogMTAwJTsgbWFyZ2luLWJvdHRvbTogOHB4OyB9XHJcblxyXG4iXSwic291cmNlUm9vdCI6IiJ9 */\"]\n    });\n  }\n}","map":{"version":3,"names":["CommonModule","FormsModule","NavbarComponent","i0","ɵɵelement","ɵɵelementStart","ɵɵlistener","ProcessDetailsComponent_div_35_Template_div_click_0_listener","$event","a_r5","ɵɵrestoreView","_r4","$implicit","ctx_r2","ɵɵnextContext","ɵɵresetView","onNodeClick","ProcessDetailsComponent_div_35_Template_div_mousedown_0_listener","onNodeMouseDown","ɵɵtext","ɵɵelementEnd","ɵɵstyleProp","x","y","ɵɵclassProp","isSelected","id","ɵɵadvance","ɵɵtextInterpolate1","name","ProcessDetailsComponent_div_36_Template_div_click_0_listener","g_r7","_r6","ProcessDetailsComponent_div_36_Template_div_mousedown_0_listener","gatewayType","ɵɵtwoWayListener","ProcessDetailsComponent_div_37_div_3_Template_input_ngModelChange_3_listener","_r8","ɵɵtwoWayBindingSet","activityForm","ProcessDetailsComponent_div_37_div_3_Template_input_ngModelChange_6_listener","activityType","ProcessDetailsComponent_div_37_div_3_Template_textarea_ngModelChange_9_listener","description","ProcessDetailsComponent_div_37_div_3_Template_button_click_10_listener","saveSelected","ProcessDetailsComponent_div_37_div_3_Template_button_click_12_listener","deleteSelected","ɵɵtwoWayProperty","ProcessDetailsComponent_div_37_div_4_Template_input_ngModelChange_3_listener","_r9","gatewayForm","ProcessDetailsComponent_div_37_div_4_Template_select_ngModelChange_6_listener","ProcessDetailsComponent_div_37_div_4_Template_textarea_ngModelChange_15_listener","conditions","ProcessDetailsComponent_div_37_div_4_Template_button_click_16_listener","ProcessDetailsComponent_div_37_div_4_Template_button_click_18_listener","ɵɵtemplate","ProcessDetailsComponent_div_37_div_3_Template","ProcessDetailsComponent_div_37_div_4_Template","ɵɵproperty","selected","type","ProcessDetailsComponent","constructor","route","router","processService","activityService","gatewayService","arcService","roleService","authService","process","activities","gateways","arcs","roles","pendingArcSource","dragging","onWindowMouseMove","event","canvas","document","querySelector","rect","getBoundingClientRect","mouseX","clientX","left","mouseY","clientY","top","newX","Math","max","offsetX","newY","offsetY","idx","findIndex","a","g","onWindowMouseUp","window","removeEventListener","find","payload","updateActivity","subscribe","updateGateway","ngOnInit","processId","Number","snapshot","paramMap","get","loadProcessDetails","loadRoles","getProcess","next","data","console","log","loadActivities","loadGateways","loadArcs","getActivitiesByProcess","getGatewaysByProcess","getArcsByProcess","user","getCurrentUser","getRolesByCompany","companyId","onPaletteDragStart","dataTransfer","setData","onCanvasDragOver","preventDefault","onCanvasDrop","getData","canvasRect","currentTarget","activity","createActivity","created","selectNode","startsWith","split","gateway","createGateway","onCanvasClick","target","classList","contains","node","closest","nodeX","nodeY","addEventListener","stopPropagation","shiftKey","source","createArc","sourceType","sourceId","targetType","targetId","updated","deleteActivity","filter","e","deleteGateway","getNodeCenterX","halfWidth","getNodeCenterY","halfHeight","ɵɵdirectiveInject","i1","ActivatedRoute","Router","i2","ProcessService","i3","ActivityService","i4","GatewayService","i5","ArcService","i6","RoleService","i7","AuthService","selectors","standalone","features","ɵɵStandaloneFeature","decls","vars","consts","template","ProcessDetailsComponent_Template","rf","ctx","ProcessDetailsComponent_Template_div_dragstart_5_listener","_r1","ProcessDetailsComponent_Template_div_dragstart_7_listener","ProcessDetailsComponent_Template_div_dragstart_13_listener","ProcessDetailsComponent_Template_div_dragstart_19_listener","ProcessDetailsComponent_Template_div_dragover_28_listener","ProcessDetailsComponent_Template_div_drop_28_listener","ProcessDetailsComponent_Template_div_click_28_listener","ProcessDetailsComponent__svg_line_31_Template","ProcessDetailsComponent_div_35_Template","ProcessDetailsComponent_div_36_Template","ProcessDetailsComponent_div_37_Template","i8","NgForOf","NgIf","i9","NgSelectOption","ɵNgSelectMultipleOption","DefaultValueAccessor","SelectControlValueAccessor","NgControlStatus","NgModel","styles"],"sources":["C:\\Users\\exmat\\ProyectoFinal\\frontend\\src\\app\\components\\process-details\\process-details.component.ts","C:\\Users\\exmat\\ProyectoFinal\\frontend\\src\\app\\components\\process-details\\process-details.component.html"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { ActivatedRoute, Router } from '@angular/router';\r\nimport { ProcessService, Process } from '../../services/process.service';\r\nimport { ActivityService, Activity } from '../../services/activity.service';\r\nimport { GatewayService, Gateway } from '../../services/gateway.service';\r\nimport { ArcService, Arc } from '../../services/arc.service';\r\nimport { RoleService, Role } from '../../services/role.service';\r\nimport { AuthService } from '../../services/auth.service';\r\nimport { NavbarComponent } from '../navbar/navbar.component';\r\n\r\n@Component({\r\n  selector: 'app-process-details',\r\n  standalone: true,\r\n  imports: [CommonModule, FormsModule, NavbarComponent],\r\n  templateUrl: './process-details.component.html',\r\n  styleUrls: ['./process-details.component.css']\r\n})\r\nexport class ProcessDetailsComponent implements OnInit {\r\n  processId!: number;\r\n  process: Process | null = null;\r\n  activities: Activity[] = [];\r\n  gateways: Gateway[] = [];\r\n  arcs: Arc[] = [];\r\n  roles: Role[] = [];\r\n\r\n  // Selection & forms\r\n  selected: { type: 'ACTIVITY' | 'GATEWAY'; id: number } | null = null;\r\n  activityForm: Partial<Activity> = {};\r\n  gatewayForm: Partial<Gateway> = {};\r\n  pendingArcSource: { type: 'ACTIVITY' | 'GATEWAY'; id: number } | null = null;\r\n  dragging: {\r\n    type: 'ACTIVITY' | 'GATEWAY';\r\n    id: number;\r\n    offsetX: number;\r\n    offsetY: number;\r\n  } | null = null;\r\n\r\n  constructor(\r\n    private route: ActivatedRoute,\r\n    private router: Router,\r\n    private processService: ProcessService,\r\n    private activityService: ActivityService,\r\n    private gatewayService: GatewayService,\r\n    private arcService: ArcService,\r\n    private roleService: RoleService,\r\n    private authService: AuthService\r\n  ) {}\r\n\r\n  ngOnInit() {\r\n    this.processId = Number(this.route.snapshot.paramMap.get('id'));\r\n    this.loadProcessDetails();\r\n    this.loadRoles();\r\n  }\r\n\r\n  loadProcessDetails() {\r\n    this.processService.getProcess(this.processId).subscribe({\r\n      next: (data) => this.process = data\r\n    });\r\n    console.log(this.process);\r\n    this.loadActivities();\r\n    this.loadGateways();\r\n    this.loadArcs();\r\n  }\r\n\r\n  loadActivities() {\r\n    this.activityService.getActivitiesByProcess(this.processId).subscribe({\r\n      next: (data) => this.activities = data\r\n    });\r\n  }\r\n\r\n  loadGateways() {\r\n    this.gatewayService.getGatewaysByProcess(this.processId).subscribe({\r\n      next: (data) => this.gateways = data\r\n    });\r\n  }\r\n\r\n  loadArcs() {\r\n    this.arcService.getArcsByProcess(this.processId).subscribe({\r\n      next: (data) => this.arcs = data\r\n    });\r\n  }\r\n\r\n  loadRoles() {\r\n    const user = this.authService.getCurrentUser();\r\n    if (user) {\r\n      this.roleService.getRolesByCompany(user.companyId).subscribe({\r\n        next: (data) => this.roles = data\r\n      });\r\n    }\r\n  }\r\n  // Palette drag start\r\n  onPaletteDragStart(event: DragEvent, payload: string) {\r\n    event.dataTransfer?.setData('text/plain', payload);\r\n  }\r\n\r\n  onCanvasDragOver(event: DragEvent) {\r\n    event.preventDefault();\r\n  }\r\n\r\n  onCanvasDrop(event: DragEvent) {\r\n    event.preventDefault();\r\n    const payload = event.dataTransfer?.getData('text/plain');\r\n    if (!payload) return;\r\n\r\n    const canvasRect = (event.currentTarget as HTMLElement).getBoundingClientRect();\r\n    const x = event.clientX - canvasRect.left;\r\n    const y = event.clientY - canvasRect.top;\r\n\r\n    if (payload === 'ACTIVITY') {\r\n      const activity: Activity = {\r\n        name: 'Activity', activityType: '', description: '', x, y\r\n      };\r\n      this.activityService.createActivity(this.processId, activity).subscribe({\r\n        next: (created) => {\r\n          this.activities = [...this.activities, created];\r\n          this.selectNode('ACTIVITY', created.id!);\r\n        }\r\n      });\r\n    } else if (payload.startsWith('GATEWAY:')) {\r\n      const type = payload.split(':')[1] as Gateway['gatewayType'];\r\n      const gateway: Gateway = {\r\n        name: type + ' Gateway', gatewayType: type, conditions: '', x, y\r\n      };\r\n      this.gatewayService.createGateway(this.processId, gateway).subscribe({\r\n        next: (created) => {\r\n          this.gateways = [...this.gateways, created];\r\n          this.selectNode('GATEWAY', created.id!);\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  onCanvasClick(event: MouseEvent) {\r\n    if ((event.target as HTMLElement).classList.contains('canvas')) {\r\n      this.selected = null;\r\n      this.pendingArcSource = null;\r\n    }\r\n  }\r\n\r\n  onNodeMouseDown(event: MouseEvent, type: 'ACTIVITY' | 'GATEWAY', node: Activity | Gateway) {\r\n    event.preventDefault();\r\n    const canvas = (event.currentTarget as HTMLElement).closest('.canvas') as HTMLElement | null;\r\n    const canvasRect = canvas ? canvas.getBoundingClientRect() : (document.querySelector('.canvas') as HTMLElement).getBoundingClientRect();\r\n    const nodeX = (node as any).x || 40;\r\n    const nodeY = (node as any).y || 40;\r\n    const mouseX = event.clientX - canvasRect.left;\r\n    const mouseY = event.clientY - canvasRect.top;\r\n    this.dragging = {\r\n      type,\r\n      id: (node as any).id,\r\n      offsetX: mouseX - nodeX,\r\n      offsetY: mouseY - nodeY\r\n    };\r\n\r\n    // Bind listeners on window to allow smooth dragging outside node element\r\n    window.addEventListener('mousemove', this.onWindowMouseMove);\r\n    window.addEventListener('mouseup', this.onWindowMouseUp);\r\n  }\r\n\r\n  onWindowMouseMove = (event: MouseEvent) => {\r\n    if (!this.dragging) return;\r\n    const canvas = document.querySelector('.canvas') as HTMLElement;\r\n    const rect = canvas.getBoundingClientRect();\r\n    const mouseX = event.clientX - rect.left;\r\n    const mouseY = event.clientY - rect.top;\r\n    const newX = Math.max(0, mouseX - this.dragging.offsetX);\r\n    const newY = Math.max(0, mouseY - this.dragging.offsetY);\r\n\r\n    if (this.dragging.type === 'ACTIVITY') {\r\n      const idx = this.activities.findIndex(a => a.id === this.dragging!.id);\r\n      if (idx >= 0) {\r\n        this.activities[idx] = { ...this.activities[idx], x: newX, y: newY };\r\n      }\r\n    } else {\r\n      const idx = this.gateways.findIndex(g => g.id === this.dragging!.id);\r\n      if (idx >= 0) {\r\n        this.gateways[idx] = { ...this.gateways[idx], x: newX, y: newY };\r\n      }\r\n    }\r\n  };\r\n\r\n  onWindowMouseUp = () => {\r\n    if (!this.dragging) return;\r\n    const { type, id } = this.dragging;\r\n    this.dragging = null;\r\n    window.removeEventListener('mousemove', this.onWindowMouseMove);\r\n    window.removeEventListener('mouseup', this.onWindowMouseUp);\r\n\r\n    if (type === 'ACTIVITY') {\r\n      const a = this.activities.find(x => x.id === id);\r\n      if (a) {\r\n        const payload: Activity = {\r\n          name: a.name,\r\n          activityType: a.activityType,\r\n          description: a.description,\r\n          x: a.x, y: a.y\r\n        };\r\n        this.activityService.updateActivity(a.id!, payload).subscribe();\r\n      }\r\n    } else {\r\n      const g = this.gateways.find(x => x.id === id);\r\n      if (g) {\r\n        const payload: Gateway = {\r\n          name: g.name,\r\n          gatewayType: g.gatewayType,\r\n          conditions: g.conditions,\r\n          x: g.x, y: g.y\r\n        };\r\n        this.gatewayService.updateGateway(g.id!, payload).subscribe();\r\n      }\r\n    }\r\n  };\r\n\r\n  onNodeClick(event: MouseEvent, type: 'ACTIVITY' | 'GATEWAY', node: Activity | Gateway) {\r\n    event.stopPropagation();\r\n    if (event.shiftKey) {\r\n      if (!this.pendingArcSource) {\r\n        this.pendingArcSource = { type, id: (node as any).id };\r\n      } else {\r\n        const source = this.pendingArcSource;\r\n        const target = { type, id: (node as any).id };\r\n        if (!(source.type === target.type && source.id === target.id)) {\r\n          this.arcService.createArc(this.processId, {\r\n            sourceType: source.type,\r\n            sourceId: source.id,\r\n            targetType: target.type,\r\n            targetId: target.id\r\n          }).subscribe({ next: (created) => {\r\n            this.arcs = [...this.arcs, created];\r\n            this.pendingArcSource = null;\r\n          }});\r\n        }\r\n      }\r\n      return;\r\n    }\r\n    this.selectNode(type, (node as any).id);\r\n  }\r\n\r\n  selectNode(type: 'ACTIVITY' | 'GATEWAY', id: number) {\r\n    this.selected = { type, id };\r\n    if (type === 'ACTIVITY') {\r\n      const a = this.activities.find(x => x.id === id)!;\r\n      this.activityForm = { name: a.name, activityType: a.activityType, description: a.description };\r\n      this.gatewayForm = {};\r\n    } else {\r\n      const g = this.gateways.find(x => x.id === id)!;\r\n      this.gatewayForm = { name: g.name, gatewayType: g.gatewayType, conditions: g.conditions };\r\n      this.activityForm = {};\r\n    }\r\n  }\r\n\r\n  isSelected(type: 'ACTIVITY' | 'GATEWAY', id?: number) {\r\n    return !!this.selected && this.selected.type === type && this.selected.id === id;\r\n  }\r\n\r\n  saveSelected() {\r\n    if (!this.selected) return;\r\n    if (this.selected.type === 'ACTIVITY') {\r\n      const a = this.activities.find(x => x.id === this.selected!.id)!;\r\n      const payload: Activity = {\r\n        name: this.activityForm.name || a.name,\r\n        activityType: this.activityForm.activityType || a.activityType,\r\n        description: this.activityForm.description || a.description,\r\n        x: a.x, y: a.y\r\n      };\r\n      this.activityService.updateActivity(a.id!, payload).subscribe({ next: (updated) => {\r\n        this.loadActivities();\r\n      }});\r\n    } else {\r\n      const g = this.gateways.find(x => x.id === this.selected!.id)!;\r\n      const payload: Gateway = {\r\n        name: this.gatewayForm.name || g.name,\r\n        gatewayType: (this.gatewayForm.gatewayType || g.gatewayType) as Gateway['gatewayType'],\r\n        conditions: this.gatewayForm.conditions || g.conditions,\r\n        x: g.x, y: g.y\r\n      };\r\n      this.gatewayService.updateGateway(g.id!, payload).subscribe({ next: () => {\r\n        this.loadGateways();\r\n      }});\r\n    }\r\n  }\r\n\r\n  deleteSelected() {\r\n    if (!this.selected) return;\r\n    if (this.selected.type === 'ACTIVITY') {\r\n      this.activityService.deleteActivity(this.selected.id).subscribe({ next: () => {\r\n        this.activities = this.activities.filter(a => a.id !== this.selected!.id);\r\n        this.arcs = this.arcs.filter(e => !(e.sourceType === 'ACTIVITY' && e.sourceId === this.selected!.id) && !(e.targetType === 'ACTIVITY' && e.targetId === this.selected!.id));\r\n        this.selected = null;\r\n      }});\r\n    } else {\r\n      this.gatewayService.deleteGateway(this.selected.id).subscribe({ next: () => {\r\n        this.gateways = this.gateways.filter(g => g.id !== this.selected!.id);\r\n        this.arcs = this.arcs.filter(e => !(e.sourceType === 'GATEWAY' && e.sourceId === this.selected!.id) && !(e.targetType === 'GATEWAY' && e.targetId === this.selected!.id));\r\n        this.selected = null;\r\n      }});\r\n    }\r\n  }\r\n\r\n  getNodeCenterX(type: 'ACTIVITY' | 'GATEWAY' | string, id: number | null | undefined) {\r\n    if (!id) return 0;\r\n    const node = type === 'ACTIVITY' ? this.activities.find(a => a.id === id) : this.gateways.find(g => g.id === id);\r\n    const halfWidth = type === 'GATEWAY' ? 18 : 50;\r\n    const x = (node?.x || 40) + halfWidth;\r\n    return x;\r\n    }\r\n\r\n  getNodeCenterY(type: 'ACTIVITY' | 'GATEWAY' | string, id: number | null | undefined) {\r\n    if (!id) return 0;\r\n    const node = type === 'ACTIVITY' ? this.activities.find(a => a.id === id) : this.gateways.find(g => g.id === id);\r\n    const halfHeight = type === 'GATEWAY' ? 18 : 20;\r\n    const y = (node?.y || 40) + halfHeight;\r\n    return y;\r\n  }\r\n}\r\n","<app-navbar></app-navbar>\r\n\r\n<div class=\"designer\">\r\n  <div class=\"sidebar\" draggable=\"false\">\r\n    <h3>Palette</h3>\r\n    <div class=\"palette-item activity\" draggable=\"true\"\r\n         (dragstart)=\"onPaletteDragStart($event, 'ACTIVITY')\">Activity</div>\r\n\r\n    <div class=\"palette-gateway\" draggable=\"true\"\r\n         (dragstart)=\"onPaletteDragStart($event, 'GATEWAY:EXCLUSIVE')\">\r\n      <div class=\"diamond\"><span class=\"marker\">×</span></div>\r\n      <span class=\"label\">Exclusive Gateway</span>\r\n    </div>\r\n    <div class=\"palette-gateway\" draggable=\"true\"\r\n         (dragstart)=\"onPaletteDragStart($event, 'GATEWAY:PARALLEL')\">\r\n      <div class=\"diamond\"><span class=\"marker\">＋</span></div>\r\n      <span class=\"label\">Parallel Gateway</span>\r\n    </div>\r\n    <div class=\"palette-gateway\" draggable=\"true\"\r\n         (dragstart)=\"onPaletteDragStart($event, 'GATEWAY:INCLUSIVE')\">\r\n      <div class=\"diamond\"><span class=\"marker\">◯</span></div>\r\n      <span class=\"label\">Inclusive Gateway</span>\r\n    </div>\r\n    <div class=\"hint\">Tip: Hold Shift and click source, then click target to create an arc.</div>\r\n  </div>\r\n\r\n  <div class=\"canvas-wrapper\">\r\n    <div class=\"canvas\"\r\n         #canvas\r\n         (dragover)=\"onCanvasDragOver($event)\"\r\n         (drop)=\"onCanvasDrop($event)\"\r\n         (click)=\"onCanvasClick($event)\">\r\n\r\n      <svg class=\"edges\" xmlns=\"http://www.w3.org/2000/svg\">\r\n        <line *ngFor=\"let arc of arcs\"\r\n              [attr.x1]=\"getNodeCenterX(arc.sourceType, arc.sourceId)\"\r\n              [attr.y1]=\"getNodeCenterY(arc.sourceType, arc.sourceId)\"\r\n              [attr.x2]=\"getNodeCenterX(arc.targetType, arc.targetId)\"\r\n              [attr.y2]=\"getNodeCenterY(arc.targetType, arc.targetId)\"\r\n              stroke=\"#999\" stroke-width=\"2\" marker-end=\"url(#arrow)\" />\r\n        <defs>\r\n          <marker id=\"arrow\" markerWidth=\"10\" markerHeight=\"10\" refX=\"10\" refY=\"3\" orient=\"auto\" markerUnits=\"strokeWidth\">\r\n            <path d=\"M0,0 L0,6 L9,3 z\" fill=\"#999\" />\r\n          </marker>\r\n        </defs>\r\n      </svg>\r\n\r\n      <div *ngFor=\"let a of activities\"\r\n           class=\"node activity-node\"\r\n           [class.selected]=\"isSelected('ACTIVITY', a.id)\"\r\n           [style.left.px]=\"a.x || 40\"\r\n           [style.top.px]=\"a.y || 40\"\r\n           (click)=\"onNodeClick($event, 'ACTIVITY', a)\"\r\n           (mousedown)=\"onNodeMouseDown($event, 'ACTIVITY', a)\">\r\n        {{ a.name || 'Activity' }}\r\n      </div>\r\n\r\n      <div *ngFor=\"let g of gateways\"\r\n           class=\"node gateway-node\"\r\n           [class.selected]=\"isSelected('GATEWAY', g.id)\"\r\n           [style.left.px]=\"g.x || 40\"\r\n           [style.top.px]=\"g.y || 40\"\r\n           (click)=\"onNodeClick($event, 'GATEWAY', g)\"\r\n           (mousedown)=\"onNodeMouseDown($event, 'GATEWAY', g)\">\r\n        <span class=\"marker\">\r\n          {{ g.gatewayType === 'EXCLUSIVE' ? '×' : (g.gatewayType === 'PARALLEL' ? '＋' : '◯') }}\r\n        </span>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n  <div class=\"inspector\" *ngIf=\"selected\">\r\n    <h3>Properties</h3>\r\n    <div *ngIf=\"selected.type === 'ACTIVITY'\">\r\n      <label>Name</label>\r\n      <input [(ngModel)]=\"activityForm.name\" />\r\n      <label>Type</label>\r\n      <input [(ngModel)]=\"activityForm.activityType\" />\r\n      <label>Description</label>\r\n      <textarea [(ngModel)]=\"activityForm.description\"></textarea>\r\n      <button (click)=\"saveSelected()\">Save</button>\r\n      <button (click)=\"deleteSelected()\">Delete</button>\r\n    </div>\r\n    <div *ngIf=\"selected.type === 'GATEWAY'\">\r\n      <label>Name</label>\r\n      <input [(ngModel)]=\"gatewayForm.name\" />\r\n      <label>Type</label>\r\n      <select [(ngModel)]=\"gatewayForm.gatewayType\">\r\n        <option value=\"EXCLUSIVE\">Exclusive</option>\r\n        <option value=\"PARALLEL\">Parallel</option>\r\n        <option value=\"INCLUSIVE\">Inclusive</option>\r\n      </select>\r\n      <label>Conditions</label>\r\n      <textarea [(ngModel)]=\"gatewayForm.conditions\"></textarea>\r\n      <button (click)=\"saveSelected()\">Save</button>\r\n      <button (click)=\"deleteSelected()\">Delete</button>\r\n    </div>\r\n  </div>\r\n</div>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}